---
title: 关于这个博客
categories:
- 网络安全
tags:
- 安全
---
# 概述
本文首先会举例介绍http存在的安全隐患，接着从正常思路由浅到深推导如何解决这些安全问题并引出HTTPS的解决方式，然后详细介绍HTTPS的整体过程，最后指出https的局限性。

# HTTP简介
http（超文本传输协议）协议是目前应用最为广泛的应用层协议。它的主要功能是基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。目前所有浏览网页的行为都离不开HTTP协议。  
HTTP的使用模型也十分简单，如下图所示，客户端机器向服务端发起HTTP请求服务端返回请求指定的资源数据。通俗的讲，使用HTTP协议传输数据就好比，你和你女神上课传纸条。

![]()

# HTTP传输问题
由于HTTP协议的下层是基于TCP/IP协议的，所以不可避免的，在传输的过程中，数据会经过多个节点进行分组转发。并且HTTP设计初期并没有对传输内容进行加密，因此HTTP协议有以下风险：
1. 窃听风险：使用明文传递，内容易被窃听;
2. 不验证通信双方的身份，可能遭遇伪装；
3. 不能证明报文是否完整，可能已遭篡改。

换句话说，在你和你女神传纸条的时候，你不能直接把纸条递给你女神，必需经过中间好几个同学帮你传一下，在这种情况下，你的情书可能被中间同学看或者篡改，甚至有人可以冒充你女神和你聊天。  

# 解决思路
## 对称加密
这时有人肯定会说，那把传输内容加个密就好了呗，就好比用个带密码的盒子将你和女神传的纸条锁起来，密码只有你和女神知道，这样传输就安全了。  

但其实在互联网的场景下是有问题的，这种以对称加密方式加密时必须将密钥也发给对方。可究竟怎样才能安全地转交？在互联网上转发密钥时，如果通信被监听那么密钥就可会落人攻击者之手，同时也就失去了加密的意义。另外还得设法安全地保管接收到的密钥。  

也就是说你和你女神其实是没有机会见面无法以说悄悄话的方式传递密码。你们需要以传纸条的方式交换密码盒的密码。    

## 非对称加密
为了解决对称加密出现的问题，有人提出的非对称加密的方式。非对称加密算法RSA使用一对秘钥，公钥和私钥。公钥用于加密数据，可以公开，私钥用于解密数据，不能公开。在使用RSA加密时即便知道公钥，密文，加密算法解密算法，在不知道私钥的情况下，也无法还原出明文。  

还使用上面的例子，女神对想和她聊天的人说，以后咱们使用RSA牌子的电子锁（RSA算法），给我发信息时，使用"520"密码（公钥）对信件进行上锁，通信的第一条信息，你需要告诉我你的密码（公钥），我在回信用这个密码给回信加锁。这样在传纸条的过程中别人无法破译内容了。  

起初这一切看起来是那么的美好，但是慢慢的你发现和你女神沟通的效率极低，一般是写信3分钟加密解密5分钟的那种（夸张），女神的回信越来越短，你们的感情越来越淡。  

## 混合加密
为了解决只是用非对称加密带来的计算量大的弊端，我们采用一种混合加密的方式，即使用非对称加密方式传输对称加密的秘钥，在正常的通信中使用对称加密的方式对传输内容进行加密。即除了第一次通信交换秘钥时使用非对称加密外，其他时间使用对称加密，这样既可以保证对称加密秘钥的传输安全又可以保证通信效率。通常来说我们把正常通信前使用非对称加密方式协商对称秘钥的过程叫做握手。  

再用传纸条的例子，你第一次和女神聊天时，先从女神那获取到公共的秘钥，然后用公共秘钥以及RSA牌电子锁把密码盒的密码传输给女神，女神确认收到后，之后就使用带密码的密码盒来聊天。  

这样感觉是完美的，但是奈何你和女神传纸条时要必经过情敌MIMT。这个MIMT非常聪明，他可以判断出女神给你发公钥的请求，并将女神的秘钥换成了自己的的公钥发给你。这时MIMT有女神的公钥，自己的公私钥，你拿到的是MIMT的公钥，并傻呵呵的用他的公钥加密了你给女神的信息传给了MIMT。由于有自己的私钥MIMT可以看你给女神发的信息，修改后用女神的公钥以你的名义发给女神。这样你和女神都以为直接和对方通信，但其实你们都是和MIMT进行通信，MIMT不但可以看你给女神发的悄悄话，还可以窜改发送的内容，挑拨你和女神的关系。  

这种攻击方式叫做中间人攻击（MIMT Man-in-the-middle attack）指攻击者与通讯的两端分别创建独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者完全控制。

## 证书体系
中间人能劫持成功的本质，还是因为链路是不安全的。所以没有被加密的握手过程一定会有。而目前我们解决问题的思路是建立证书体系，由权威机构来提供发放、验证证书的服务，证书中带有权威认证的身份（域名）与公钥的对相应关系以及其他相关信息。简单来说，一个HTTPS网站响应给我们的并不是一个公钥，而是证书。证书上不但包含了公钥，还包含了域名、签发机构、有效期、签名等等。  

如何确认证书的有效性呢，这就要提到证书中带的签名了。